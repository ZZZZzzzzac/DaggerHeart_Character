<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>角色创建器</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="css/domain.css">
    <link rel="stylesheet" href="css/newbie.css">
    <link rel="stylesheet" href="css/equipment.css">
    <link rel="stylesheet" href="css/skill.css">
    <!-- 添加一个 base 标签以确保所有相对路径都从根目录开始 -->
    <base href="./">
</head>
<body>
    <!-- <h1>角色创建器</h1> -->
    <form id="characterForm">
        <div class="two-column-layout">
            <div class="left-column">
                <!-- <h2>设定</h2> -->
                <div class="form-group-row"> <!-- Row 1: Name, Age, Gender, Level -->
                    <div>
                        <label for="roleName">名字:</label>
                        <input type="text" id="roleName" name="roleName">
                    </div>
                    <div>
                        <label for="age">年龄:</label>
                        <input type="number" id="age" name="age" value="0">
                    </div>
                    <div>
                        <label for="gender">性别:</label>
                        <input type="text" id="gender" name="gender">
                    </div>
                    <div>
                        <label for="level">等级:</label>
                        <input type="number" id="level" name="level" value="1">
                        <span id="levelTierDisplay" class="tier-display"></span>
                    </div>
                </div>
                <div class="form-group-row"> <!-- Row 2: Race, Mixed Race, Community -->
                    <div>
                        <label for="raceSelect">种族:</label>
                        <select id="raceSelect" name="race"></select>
                    </div>
                    <div>
                        <label for="mixedRaceSelect">混血:</label>
                        <select id="mixedRaceSelect" name="mixedRace"></select>
                    </div>
                    <div>
                        <label for="communitySelect">社群:</label>
                        <select id="communitySelect" name="community"></select>
                    </div>
                </div>
                <div class="form-group-row"> <!-- Row 3: Profession, Sub-Profession, Part-Time Job -->
                    <div>
                        <label for="professionSelect">职业:</label>
                        <select id="professionSelect" name="profession"></select>
                    </div>
                    <div>
                        <label for="subProfession">子职:</label>
                        <select id="subclassSelect" name="subProfession"></select>
                    </div>
                    <div>
                        <label for="partTimeJob">兼职:</label>
                        <input type="text" id="partTimeJob" name="partTimeJob">
                    </div>
                </div>

                <div class="section-header"><h3>经历</h3><button type="button" class="add-btn" id="addExperienceBtn">+</button></div>
                <div id="experiences" class="item-container">
                    <div class="experience-item">
                        <input type="text" id="expKeyword" name="expKeyword" placeholder="关键词">
                        <input type="text" id="expValue" name="expValue" placeholder="调整值" value="2">
                        <button type="button" class="remove-item-btn">-</button>
                    </div>
                    <div class="experience-item">
                        <input type="text" id="expKeyword2" name="expKeyword" placeholder="关键词">
                        <input type="text" id="expValue2" name="expValue" placeholder="调整值" value="2">
                        <button type="button" class="remove-item-btn">-</button>
                    </div>
                </div>
                <div class="form-group-inline-flex story-appearance-group">
                    <div class="story-group">
                        <textarea id="backgroundStory" name="backgroundStory" placeholder="背景故事"></textarea>
                    </div>
                    <div class="appearance-group">
                        <!-- Removed label for appearanceUpload -->
                        <input type="file" id="appearanceUpload" name="appearanceUpload" accept="image/*">
                        <div class="image-preview-container">
                            <img id="appearancePreview" src="#" alt="形象预览" style="max-width: 150px; max-height: 150px; display: none; margin-top: 10px;">
                            <span id="removeAppearanceBtn" class="remove-image-btn" style="display: none;">&times;</span>
                        </div>
                    </div>
                </div>

                <!-- <h2>状态</h2> -->
                <div class="form-group-inline-flex"> <!-- Group status fields -->
                    <div>
                        <label for="hpCurrent">HP:</label>
                        <input type="number" id="hpCurrent" name="hpCurrent" value="6" title="当前HP">
                        <span class="status-separator">/</span>
                        <input type="number" id="hpMax" name="hpMax" value="6" title="最大HP">
                    </div>
                    <div>
                        <label for="stressCurrent">压力:</label>
                        <input type="number" id="stressCurrent" name="stressCurrent" value="0" title="当前压力">
                        <span class="status-separator">/</span>
                        <input type="number" id="stressMax" name="stressMax" value="6" title="最大压力">
                    </div>
                    <div>
                        <label for="hopeCurrent">希望:</label>
                        <input type="number" id="hopeCurrent" name="hopeCurrent" value="2" title="当前希望">
                        <span class="status-separator">/</span>
                        <input type="number" id="hopeMax" name="hopeMax" value="6" title="最大希望">
                    </div>
                    <div>
                        <label for="armorCurrent">护甲槽:</label>
                        <input type="number" id="armorCurrent" name="armorCurrent" value="0" title="当前护甲">
                        <span class="status-separator">/</span>
                        <input type="number" id="armorMax" name="armorMax" value="6" title="最大护甲">
                    </div>
                </div> <!-- End of first form-group-inline-flex for HP, Stress, etc. -->
                <div class="form-group-inline-flex"> <!-- New group for Armor Value, Level, Proficiency, Money -->
                    <div>
                        <label for="proficiency">熟练:</label>
                        <input type="number" id="proficiency" name="proficiency" value="1">
                    </div>
                    <div>
                        <label for="money">金钱:</label>
                        <input type="number" id="money" name="money" value="0">
                    </div>
                    <div>
                        <label for="majorDamageThreshold">受伤阈值:</label>
                        <input type="number" id="majorDamageThreshold" name="majorDamageThreshold" value="0">
                        <span class="status-separator">/</span>
                        <input type="number" id="severeDamageThreshold" name="severeDamageThreshold" value="0">
                    </div>
                    <div>
                        <label for="armorValue">护甲值:</label>
                        <input type="number" id="armorValue" name="armorValue" value="0">
                    </div>
                </div> <!-- End of group for Armor Value, Level, etc. -->
                <div class="form-group-inline-flex"> <!-- Group for former attributes -->
                    <div>
                        <label for="strength">力量:</label>
                        <input type="number" id="strength" name="strength" value="0">
                    </div>
                    <div>
                        <label for="agility">敏捷:</label>
                        <input type="number" id="agility" name="agility" value="0">
                    </div>
                    <div>
                        <label for="dexterity">灵巧:</label>
                        <input type="number" id="dexterity" name="dexterity" value="0">
                    </div>
                    <div>
                        <label for="instinct">本能:</label>
                        <input type="number" id="instinct" name="instinct" value="0">
                    </div>
                    <div>
                        <label for="knowledge">知识:</label>
                        <input type="number" id="knowledge" name="knowledge" value="0">
                    </div>
                    <div>
                        <label for="grace">风度:</label>
                        <input type="number" id="grace" name="grace" value="0">
                    </div>
                </div> <!-- End of new group for former attributes -->

                <!-- <h2>物品</h2> -->
                <div class="weapons-section"> <!-- Parent container for weapons -->
                    <!-- Removed <div class="section-header"><h3>武器</h3></div> -->
                    <div class="weapons-layout"> <!-- Container for the weapon boxes themselves -->
                        <div id="weapon1-container" class="weapon-item-container">
                            <div class="item">
                                <h4>主要武器</h4>
                                <input type="text" id="weaponName1" name="weaponName1" placeholder="名称(点击此处换装)">
                                <input type="text" id="weaponCheck1" name="weaponCheck1" placeholder="检定">
                                <input type="text" id="weaponAttribute1" name="weaponAttribute1" placeholder="属性">
                                <input type="text" id="weaponRange1" name="weaponRange1" placeholder="范围">
                                <input type="text" id="weaponDamage1" name="weaponDamage1" placeholder="伤害">
                                <input type="text" id="weaponTwoHanded1" name="weaponTwoHanded1" placeholder="负荷">
                            </div>
                            <div class="item-row">
                                <textarea id="weaponTrait1" name="weaponTrait1" placeholder="特性"></textarea>
                            </div>
                        </div>
                        <div id="weapon2-container" class="weapon-item-container">
                            <div class="item">
                                <h4>辅助武器</h4>
                                <input type="text" id="weaponName2" name="weaponName2" placeholder="名称(点击此处换装)">
                                <input type="text" id="weaponCheck2" name="weaponCheck2" placeholder="检定">
                                <input type="text" id="weaponAttribute2" name="weaponAttribute2" placeholder="属性">
                                <input type="text" id="weaponRange2" name="weaponRange2" placeholder="范围">
                                <input type="text" id="weaponDamage2" name="weaponDamage2" placeholder="伤害">
                                <input type="text" id="weaponTwoHanded2" name="weaponTwoHanded2" placeholder="负荷">
                            </div>
                            <div class="item-row">
                                <textarea id="weaponTrait2" name="weaponTrait2" placeholder="特性"></textarea>
                            </div>
                        </div>
                        <div id="weapon3-container" class="weapon-item-container">
                            <div class="item">
                                <h4>库存武器</h4> <!-- Will be treated as a main weapon by JS -->
                                <input type="text" id="weaponName3" name="weaponName3" placeholder="名称(点击此处换装)">
                                <input type="text" id="weaponCheck3" name="weaponCheck3" placeholder="检定">
                                <input type="text" id="weaponAttribute3" name="weaponAttribute3" placeholder="属性">
                                <input type="text" id="weaponRange3" name="weaponRange3" placeholder="范围">
                                <input type="text" id="weaponDamage3" name="weaponDamage3" placeholder="伤害">
                                <input type="text" id="weaponTwoHanded3" name="weaponTwoHanded3" placeholder="负荷">
                            </div>
                            <div class="item-row">
                                <textarea id="weaponTrait3" name="weaponTrait3" placeholder="特性"></textarea>
                            </div>
                        </div>
                        <div id="weapon4-container" class="weapon-item-container">
                            <div class="item">
                                <h4>库存武器</h4> <!-- Will be treated as an auxiliary weapon by JS -->
                                <input type="text" id="weaponName4" name="weaponName4" placeholder="名称(点击此处换装)">
                                <input type="text" id="weaponCheck4" name="weaponCheck4" placeholder="检定">
                                <input type="text" id="weaponAttribute4" name="weaponAttribute4" placeholder="属性">
                                <input type="text" id="weaponRange4" name="weaponRange4" placeholder="范围">
                                <input type="text" id="weaponDamage4" name="weaponDamage4" placeholder="伤害">
                                <input type="text" id="weaponTwoHanded4" name="weaponTwoHanded4" placeholder="负荷">
                            </div>
                            <div class="item-row">
                                <textarea id="weaponTrait4" name="weaponTrait4" placeholder="特性"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="armors" class="item-container armor-item-container"> <!-- Container for items, added armor-item-container -->
                    <div class="item">
                        <h4>护甲</h4> <!-- Moved H3 into item and changed to H4 for consistency -->
                        <input type="text" id="armorName1" name="armorName1" placeholder="名称(点击此处换装)">
                        <input type="text" id="armorDefense1" name="armorDefense1" placeholder="护甲值">
                        <input type="text" id="armorMajorThreshold1" name="armorMajorThreshold1" placeholder="重伤阈值">
                        <input type="text" id="armorSevereThreshold1" name="armorSevereThreshold1" placeholder="致命阈值">
                    </div>
                    <div class="item-row">
                        <textarea id="armorTrait1" name="armorTrait1" placeholder="特性"></textarea>
                    </div>
                </div>
                <div class="section-header"><h3>道具</h3><button type="button" class="add-btn" id="addItemBtn">+</button></div>
                <div id="items" class="item-container">
                    <div class="item">
                        <select id="itemName" name="itemName" class="item-name-select"></select>
                        <input type="text" id="itemQuantity" name="itemQuantity" placeholder="数量" value="1">
                        <textarea id="itemDescription" name="itemDescription" placeholder="描述"></textarea>
                        <button type="button" class="remove-item-btn">-</button>
                    </div>
                </div>
            </div> <!-- End left-column -->

            <div class="right-column">
                <div class="section-header">
                    <h3>技能</h3>
                    <button type="button" class="add-btn" id="addSkillBtn">+</button>
                    <div id="jobDomainsDisplay" class="job-domains-display"></div>
                </div>
                <table id="skillsTable" class="skills-table">
                    <tbody id="skillsContainer">
                        <!-- Initial skill items will be added by script if needed -->
                    </tbody>
                </table>
            </div> <!-- End right-column -->
        </div> <!-- End two-column-layout -->
        <div class="form-actions">
            <button type="button" id="importJsonBtn">导入JSON</button>
            <input type="file" id="importFile" accept=".json" style="display: none;">
            <button type="button" id="exportJson">导出JSON</button>
            <button type="button" id="newbieGuideButton">新人引导</button>
        </div>
    </form>

    <script src="data/Daggerheart_Core_Rulebook_种族.js"></script>
    <script src="data/Daggerheart_Core_Rulebook_社群.js"></script>
    <script src="data/Daggerheart_Core_Rulebook_职业.js"></script>    
    <script src="data/Daggerheart_Core_Rulebook_战利品与消耗品表.js"></script>
    <script src="data/Daggerheart_Core_Rulebook_主武器表.js"></script>
    <script src="data/Daggerheart_Core_Rulebook_副武器表.js"></script>
    <script src="data/Daggerheart_Core_Rulebook_护甲表.js"></script>
    <script src="data/template.js"></script>
    <script src="data/Daggerheart_Core_Rulebook_领域卡.js"></script> <!-- New data file -->
    <script src="js/utility.js"></script>
    <script src="js/race_job_community.js"></script>
    <script src="js/weapon_armor_item.js"></script>
    <script src="js/skill.js"></script>
    <script src="js/json.js"></script>
    <script src="js/newbie.js"></script>
    <script src="js/domain_card.js"></script> <!-- Logic file, keep one instance -->
    <script src="script.js"></script>

    <!-- Equipment Modal -->
    <div id="equipmentModal" class="modal">
        <div class="modal-content">
            <span id="modalCloseButton" class="modal-close-button">&times;</span>
            <h3 id="modalTitle">选择装备</h3>
            <div id="fixedHeaderContainer" class="fixed-header-container">
                <!-- 表头将在这里通过JS动态添加或静态放置 -->
            </div>
            <div id="equipmentListContainer" class="equipment-list">
                <!-- Equipment items will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Domain Card Modal -->
    <div id="domainCardModal" class="modal">
        <div class="modal-content">
            <span id="domainCardModalCloseButton" class="modal-close-button">&times;</span>
            <h3 id="domainCardModalTitle">选择领域卡</h3>
            <!-- Optional: Add filter input if needed later -->
            <!-- <input type="text" id="domainCardFilterInput" placeholder="筛选领域卡..." class="modal-filter-input"> -->
            <div id="domainCardListContainer" class="domain-card-list">
                <!-- Domain cards will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Newbie Guide Modal -->
    <div id="newbieGuideModal" class="modal">
        <div class="modal-content">
            <span id="newbieGuideModalCloseButton" class="modal-close-button">&times;</span>
            <div class="newbie-guide-layout">
                <div class="newbie-guide-main-content">
                    <h3>新人引导</h3>
                    <div id="newbieGuideQuestionText" class="guide-question-text"></div>
                    <textarea id="newbieGuideAnswerInput" class="guide-answer-input" placeholder="请在此输入答案"></textarea>
                    <select id="newbieGuideDropdownInput" class="guide-answer-input" style="display: none;"></select>
                    <!-- <textarea id="newbieGuideAnswerTextarea" class="guide-answer-input" style="display:none;" placeholder="请在此输入答案"></textarea> -->
                </div>
                <textarea id="newbieGuidePromptTextarea" placeholder="根据你的选择，这里会显示相关的提示词..." readonly></textarea>
            </div>
            <!-- Removed newbieGuideAttributesContainer -->
            <div class="modal-actions">
                <button type="button" id="newbieGuideCancelButton">上一步</button>
                <button type="button" id="newbieGuideNextButton">下一步</button>
            </div>
        </div>
    </div>
</body>
</html>